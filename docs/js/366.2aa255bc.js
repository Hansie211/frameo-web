"use strict";(self["webpackChunkframeo_web"]=self["webpackChunkframeo_web"]||[]).push([[366],{9366:(e,t,i)=>{i.r(t),i.d(t,{default:()=>pe});var n=i(9835),o=i(6970);const r=e=>((0,n.dD)("data-v-f66f77e6"),e=e(),(0,n.Cn)(),e),a={id:"content-pane"},s={id:"media-box"},d=r((()=>(0,n._)("div",{id:"click-box"},null,-1))),l={class:"media"},u={class:"media"};function c(e,t,i,r,c,h){const v=(0,n.up)("image-display"),m=(0,n.up)("video-display"),p=(0,n.up)("date-block"),g=(0,n.up)("version-block"),x=(0,n.up)("q-page");return(0,n.wg)(),(0,n.j4)(x,{class:"flex flex-center"},{default:(0,n.w5)((()=>{var t;return[(0,n._)("div",a,[(0,n._)("div",s,[d,(0,n._)("div",l,[(0,n.Wm)(v,{class:(0,o.C_)({fade:!0,"fade-in":e.displayImage}),ref:"imageDisplay",onLoad:e.onMediaLoad,onError:e.onMediaError},null,8,["class","onLoad","onError"])]),(0,n._)("div",u,[(0,n.Wm)(m,{class:(0,o.C_)({fade:!0,"fade-in":!e.displayImage}),ref:"videoDisplay",onLoad:e.onMediaLoad,onError:e.onMediaError},null,8,["class","onLoad","onError"])])]),(0,n.Wm)(p,{id:"date",value:null===(t=e.currentMedia)||void 0===t?void 0:t.date},null,8,["value"]),(0,n.Wm)(g,{id:"version",value:e.version},null,8,["value"])])]})),_:1})}const h={id:"container"},v=["src"];function m(e,t,i,r,a,s){return(0,n.wg)(),(0,n.iD)("div",h,[(0,n._)("div",{id:"backdrop",style:(0,o.j5)({backgroundImage:"url("+e.currentSource+")"})},null,4),(0,n._)("img",{id:"image-main",src:e.currentSource},null,8,v)])}const p=(0,n.aZ)({name:"ImageDisplay",emits:["load","error"],data(){return{currentSource:"",nextSource:""}},methods:{onImageLoad(){this.$emit("load"),this.currentSource=this.nextSource},stop(){console.log("Stop image display"),this.currentSource=null},start(e){console.log(`Start load image ${e}`);const t=new Image;t.onload=this.onImageLoad,t.onerror=e=>{this.$emit("error",e)},t.src=this.nextSource=e}}});var g=i(1639);const x=(0,g.Z)(p,[["render",m],["__scopeId","data-v-19d9b675"]]),f=x;i(702);var y=i(1957);const I={id:"container"},w={id:"spinner"},_=["v-show"],M=["src"];function S(e,t,i,o,r,a){const s=(0,n.up)("q-spinner");return(0,n.wg)(),(0,n.iD)("div",I,[(0,n.wy)((0,n._)("div",w,[(0,n.Wm)(s,{color:"primary",size:"3em",thickness:10})],512),[[y.F8,e.loading]]),(0,n._)("div",{id:"black-overlay","v-show":!e.hidden},null,8,_),(0,n._)("video",{id:"video",ref:"video",muted:"",autoplay:"",loop:"",onLoadeddata:t[0]||(t[0]=(...t)=>e.onVideoLoad&&e.onVideoLoad(...t)),onError:t[1]||(t[1]=(...t)=>e.onVideoError&&e.onVideoError(...t))},[null!==e.source?((0,n.wg)(),(0,n.iD)("source",{key:0,src:e.source,type:"video/mp4"},null,8,M)):(0,n.kq)("",!0)],544)])}const b=(0,n.aZ)({name:"VideoDisplay",emits:["load","error"],data(){return{source:null,loading:!1,hidden:!0}},computed:{video(){return this.$refs.video}},methods:{onVideoLoad(){this.$emit("load"),this.loading=!1,this.video.currentTime=0,this.video.play()},onVideoError(e){this.$emit("error",e)},stop(){console.log("Stop video display"),this.video.pause(),this.hidden=!0},start(e){console.log(`Start load video ${e}`),this.loading=!0,this.source=e,this.video.load(),this.hidden=!1}}});var k=i(3940),D=i(9984),L=i.n(D);const $=(0,g.Z)(b,[["render",S],["__scopeId","data-v-900b725e"]]),E=$;L()(b,"components",{QSpinner:k.Z});const Z=e=>((0,n.dD)("data-v-94ec37ae"),e=e(),(0,n.Cn)(),e),C={id:"date"},V=Z((()=>(0,n._)("div",{id:"nailbar"},[(0,n._)("div",{class:"nail"}),(0,n._)("div",{class:"nail"})],-1))),z={id:"content"},N={class:"text"},W={class:"text"},O={class:"text"};function A(e,t,i,r,a,s){return(0,n.wg)(),(0,n.iD)("div",C,[V,(0,n._)("div",z,[(0,n._)("div",N,(0,o.zw)(e.dayName),1),(0,n._)("div",W,(0,o.zw)(e.day)+" "+(0,o.zw)(e.monthName)+" "+(0,o.zw)(e.year),1),(0,n._)("div",O,(0,o.zw)(e.hour)+":"+(0,o.zw)(e.minute),1)])])}i(6727);function B(e){return e<10?"0"+e:e}function q(e){return(null===e||void 0===e?void 0:e.charAt(0).toUpperCase())+(null===e||void 0===e?void 0:e.slice(1))}function Q(e,t){if(void 0!==e){while(e.length>0&&t.includes(e.charAt(e.length-1)))e=e.slice(0,-1);return e}}const j="nl-NL",F=(0,n.aZ)({name:"DateBlock",props:{value:{type:String,default:null}},computed:{date(){return null===this.value?null:new Date(this.value.toString())},year(){var e;return null===(e=this.date)||void 0===e?void 0:e.getFullYear()},month(){var e;return B((null===(e=this.date)||void 0===e?void 0:e.getMonth())+1)},day(){var e;return null===(e=this.date)||void 0===e?void 0:e.getDate()},hour(){var e;return B(null===(e=this.date)||void 0===e?void 0:e.getHours())},minute(){var e;return B(null===(e=this.date)||void 0===e?void 0:e.getMinutes())},monthName(){var e;const t={month:"short"};return Q(null===(e=this.date)||void 0===e?void 0:e.toLocaleDateString(j,t).toString(),".")},dayName(){var e;const t={weekday:"long"};return q(null===(e=this.date)||void 0===e?void 0:e.toLocaleDateString(j,t).toString())},text(){if(null===this.value)return null;const e={weekday:"long",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"},t=new Date(this.value.toString()),i=t.toLocaleDateString("nl-NL",e).toString();return i.charAt(0).toUpperCase()+i.slice(1)}}}),J=(0,g.Z)(F,[["render",A],["__scopeId","data-v-94ec37ae"]]),P=J,T={id:"version"};function U(e,t,i,r,a,s){return(0,n.wg)(),(0,n.iD)("div",T,(0,o.zw)(e.value),1)}const H=(0,n.aZ)({name:"VersionBlock",props:{value:{type:String,default:null}}}),Y=(0,g.Z)(H,[["render",U],["__scopeId","data-v-dc4d8a6e"]]),G=Y;var K=i(1644),R=i(7363);const X=JSON.parse('{"timeout":3000,"cutoff-video":true}'),ee=(0,R.Q_)("SettingsStore",{state:()=>X,actions:{}});var te=i(932),ie=i.n(te),ne=i(3511),oe=i.n(ne),re=i(6031),ae=i.n(re),se=(i(6822),new WeakMap);class de{constructor(){ie()(this,se,{writable:!0,value:void 0}),ae()(this,se,new Map)}on(e,t){oe()(this,se).has(e)?oe()(this,se).get(e).push(t):oe()(this,se).set(e,[t])}trigger(e,...t){for(const i of oe()(this,se).get(e)||[])i(...t)}}var le=new WeakMap,ue=new WeakMap;class ce extends de{constructor(){super(),ie()(this,le,{writable:!0,value:void 0}),ie()(this,ue,{writable:!0,value:void 0}),ae()(this,le,-1),ae()(this,ue,0),this.peekIndex=this.peekIndex.bind(this),this.popIndex=this.popIndex.bind(this),this.getIndex=this.getIndex.bind(this),this.setIndex=this.setIndex.bind(this),this.getMax=this.getMax.bind(this),this.setMax=this.setMax.bind(this),this.removeIndex=this.removeIndex.bind(this),this.addOne=this.addOne.bind(this)}peekIndex(e=1){if("number"!==typeof e)throw new Error("Cannot read count as number");if(e<1)throw new Error("Cannot peek with less than 1");return 0===this.getMax()?-1:(this.getIndex()+e)%this.getMax()}popIndex(e=1){this.setIndex(this.peekIndex(e))}getIndex(){return oe()(this,le)}setIndex(e){if(e===oe()(this,le))return;const t=oe()(this,le);ae()(this,le,e),this.trigger("indexchanged",e,t)}getMax(){return oe()(this,ue)}setMax(e){ae()(this,ue,e)}removeIndex(e){oe()(this,le)>=e&&this.setIndex(oe()(this,le)-1)}addOne(){this.setMax(oe()(this,ue)+1),1===this.getMax()&&this.setIndex(0)}}const he=(0,n.aZ)({components:{ImageDisplay:f,VideoDisplay:E,DateBlock:P,VersionBlock:G},name:"IndexPage",setup(){const e=(0,K.Z)(),t=new ce;return e.$onAction((({name:e,store:i,args:n,after:o,onError:r})=>{switch(e){case"addItem":o((e=>{!1!==e&&t.addOne()}));break;case"removeItem":{const e=n[0];o((i=>{!1!==i&&t.removeIndex(e)}));break}}})),{mediaStore:e,cycleManager:t,settingsStore:ee(),version:"v0.1.2"}},created(){this.cycleManager.on("indexchanged",((e,t)=>{var i,n;if(console.debug(`Index changed from ${t} -> ${e}`),e<0)return;const o=this.mediaStore.mediaItems[e];if(void 0===o)return;const r=this.mediaStore.mediaItems[t],a=void 0===r||r.is_video!==o.is_video;var s;(a&&o.is_video&&(null===(i=this.$refs.videoDisplay)||void 0===i||i.stop()),a&&!o.is_video&&(null===(n=this.$refs.imageDisplay)||void 0===n||n.stop()),this.displayImage=!o.is_video,this.displayImage)?this.$refs.imageDisplay.start(o.url):null===(s=this.$refs.videoDisplay)||void 0===s||s.start(o.url);this.currentMedia=o}))},data(){return{displayImage:!0,currentMedia:null}},computed:{timeout(){return this.settingsStore.timeout}},watch:{"mediaStore.count"(e,t){}},methods:{nextMedia(){this.cycleManager.popIndex()},onMediaLoad(){this.timer=setTimeout((()=>this.nextMedia()),this.timeout)},onMediaError(e){var t;const i=this.currentMedia?this.currentMedia.is_video?"video":"image":"?",n=null!==(t=this.currentMedia.source)&&void 0!==t?t:"?";alert(`Could not load ${i} from source ${n} (${JSON.stringify(e)})`),this.nextMedia()}}});var ve=i(9885);const me=(0,g.Z)(he,[["render",c],["__scopeId","data-v-f66f77e6"]]),pe=me;L()(he,"components",{QPage:ve.Z})}}]);
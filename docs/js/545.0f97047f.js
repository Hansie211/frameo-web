"use strict";(self["webpackChunkframeo_web"]=self["webpackChunkframeo_web"]||[]).push([[545],{3545:(e,t,i)=>{i.r(t),i.d(t,{default:()=>ne});var o=i(9835),s=i(6970);const n=e=>((0,o.dD)("data-v-f011a9fa"),e=e(),(0,o.Cn)(),e),a={id:"content-pane"},d={id:"media-box"},r=n((()=>(0,o._)("div",{id:"click-box"},null,-1))),l={class:"media"},c={class:"media"};function u(e,t,i,n,u,h){const p=(0,o.up)("image-display"),v=(0,o.up)("video-display"),m=(0,o.up)("date-block"),g=(0,o.up)("version-block"),f=(0,o.up)("q-page");return(0,o.wg)(),(0,o.j4)(f,{class:"flex flex-center"},{default:(0,o.w5)((()=>{var t;return[(0,o._)("div",a,[(0,o._)("div",d,[r,(0,o._)("div",l,[(0,o.Wm)(p,{class:(0,s.C_)({fade:!0,"fade-in":e.displayImage}),ref:"imageDisplay",onLoad:e.onMediaLoad},null,8,["class","onLoad"])]),(0,o._)("div",c,[(0,o.Wm)(v,{class:(0,s.C_)({fade:!0,"fade-in":!e.displayImage}),ref:"videoDisplay",onLoad:e.onMediaLoad},null,8,["class","onLoad"])])]),(0,o.Wm)(m,{id:"date",value:null===(t=e.currentMedia)||void 0===t?void 0:t.date},null,8,["value"]),(0,o.Wm)(g,{id:"version",value:e.version},null,8,["value"])])]})),_:1})}const h={id:"container"},p=["src"];function v(e,t,i,n,a,d){return(0,o.wg)(),(0,o.iD)("div",h,[(0,o._)("div",{id:"backdrop",style:(0,s.j5)({backgroundImage:"url("+e.currentSource+")"})},null,4),(0,o._)("img",{id:"image-main",src:e.currentSource},null,8,p)])}const m=(0,o.aZ)({name:"ImageDisplay",emits:["load"],data(){return{currentSource:"",nextSource:""}},methods:{onImageLoad(){this.$emit("load"),this.currentSource=this.nextSource},stop(){console.log("Stop image display"),this.currentSource=null},start(e){console.log(`Start load image ${e}`);const t=new Image;t.onload=this.onImageLoad,t.onerror=e=>{this.$emit("load"),alert(`Could not load image ${this.url} (${JSON.stringify(e)})`)},t.src=this.nextSource=e}}});var g=i(1639);const f=(0,g.Z)(m,[["render",v],["__scopeId","data-v-682437ba"]]),x=f;i(702);var I=i(1957);const y={id:"container"},w={id:"spinner"},_=["v-show"],S=["src"];function b(e,t,i,s,n,a){const d=(0,o.up)("q-spinner");return(0,o.wg)(),(0,o.iD)("div",y,[(0,o.wy)((0,o._)("div",w,[(0,o.Wm)(d,{color:"primary",size:"3em",thickness:10})],512),[[I.F8,e.loading]]),(0,o._)("div",{id:"black-overlay","v-show":e.hidden},null,8,_),(0,o._)("video",{id:"video",ref:"video",muted:"",autoplay:"",loop:"",onLoadeddata:t[0]||(t[0]=(...t)=>e.onVideoLoad&&e.onVideoLoad(...t)),onError:t[1]||(t[1]=(...t)=>e.onVideoError&&e.onVideoError(...t))},[null!==e.source?((0,o.wg)(),(0,o.iD)("source",{key:0,src:e.source,type:"video/mp4"},null,8,S)):(0,o.kq)("",!0)],544)])}const k=(0,o.aZ)({name:"VideoDisplay",emits:["load"],data(){return{source:null,loading:!1,hidden:!0}},computed:{video(){return this.$refs.video}},methods:{onVideoLoad(){this.$emit("load"),this.loading=!1,this.video.currentTime=0,this.video.play()},onVideoError(e){this.$emit("load"),alert(`Could not load video ${this.source} (${JSON.stringify(e)})`)},stop(){console.log("Stop video display"),this.video.pause(),this.hidden=!0},start(e){console.log(`Start load video ${e}`),this.loading=!0,this.source=e,this.video.load(),this.hidden=!1}}});var M=i(3940),D=i(9984),$=i.n(D);const L=(0,g.Z)(k,[["render",b],["__scopeId","data-v-2f193aae"]]),Z=L;$()(k,"components",{QSpinner:M.Z});const C={id:"date"};function V(e,t,i,n,a,d){return(0,o.wg)(),(0,o.iD)("div",C,(0,s.zw)(e.text),1)}const W=(0,o.aZ)({name:"DateBlock",props:{value:{type:String,default:null}},computed:{text(){if(null===this.value)return null;const e={weekday:"long",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"},t=new Date(this.value.toString()),i=t.toLocaleDateString("nl-NL",e).toString();return i.charAt(0).toUpperCase()+i.slice(1)}}}),E=(0,g.Z)(W,[["render",V],["__scopeId","data-v-469ff13c"]]),O=E,B={id:"version"};function N(e,t,i,n,a,d){return(0,o.wg)(),(0,o.iD)("div",B,(0,s.zw)(e.value),1)}const q=(0,o.aZ)({name:"VersionBlock",props:{value:{type:String,default:null}}}),z=(0,g.Z)(q,[["render",N],["__scopeId","data-v-dc4d8a6e"]]),J=z;var Q=i(1644),j=i(7363);const A=JSON.parse('{"timeout":3000,"cutoff-video":true}'),P=(0,j.Q_)("SettingsStore",{state:()=>A,actions:{}});var T=i(932),F=i.n(T),U=i(3511),G=i.n(U),H=i(6031),K=i.n(H),R=(i(6822),new WeakMap);class X{constructor(){F()(this,R,{writable:!0,value:void 0}),K()(this,R,new Map)}on(e,t){G()(this,R).has(e)?G()(this,R).get(e).push(t):G()(this,R).set(e,[t])}trigger(e,...t){for(const i of G()(this,R).get(e)||[])i(...t)}}var Y=new WeakMap,ee=new WeakMap;class te extends X{constructor(){super(),F()(this,Y,{writable:!0,value:void 0}),F()(this,ee,{writable:!0,value:void 0}),K()(this,Y,-1),K()(this,ee,0),this.peekIndex=this.peekIndex.bind(this),this.popIndex=this.popIndex.bind(this),this.getIndex=this.getIndex.bind(this),this.setIndex=this.setIndex.bind(this),this.getMax=this.getMax.bind(this),this.setMax=this.setMax.bind(this),this.removeIndex=this.removeIndex.bind(this),this.addOne=this.addOne.bind(this)}peekIndex(e=1){if("number"!==typeof e)throw new Error("Cannot read count as number");if(e<1)throw new Error("Cannot peek with less than 1");return 0===this.getMax()?-1:(this.getIndex()+e)%this.getMax()}popIndex(e=1){this.setIndex(this.peekIndex(e))}getIndex(){return G()(this,Y)}setIndex(e){if(e===G()(this,Y))return;const t=G()(this,Y);K()(this,Y,e),this.trigger("indexchanged",e,t)}getMax(){return G()(this,ee)}setMax(e){K()(this,ee,e)}removeIndex(e){G()(this,Y)>=e&&this.setIndex(G()(this,Y)-1)}addOne(){this.setMax(G()(this,ee)+1),1===this.getMax()&&this.setIndex(0)}}const ie=(0,o.aZ)({components:{ImageDisplay:x,VideoDisplay:Z,DateBlock:O,VersionBlock:J},name:"IndexPage",setup(){const e=(0,Q.Z)(),t=new te;return e.$onAction((({name:e,store:i,args:o,after:s,onError:n})=>{switch(e){case"addItem":s((e=>{!1!==e&&t.addOne()}));break;case"removeItem":{const e=o[0];s((i=>{!1!==i&&t.removeIndex(e)}));break}}})),{mediaStore:e,cycleManager:t,settingsStore:P(),version:"v0.1.1"}},created(){this.cycleManager.on("indexchanged",((e,t)=>{var i,o;if(console.debug(`Index changed from ${t} -> ${e}`),e<0)return;const s=this.mediaStore.mediaItems[e];if(void 0===s)return;const n=this.mediaStore.mediaItems[t],a=void 0===n||n.is_video!==s.is_video;var d;(a&&s.is_video&&(null===(i=this.$refs.videoDisplay)||void 0===i||i.stop()),a&&!s.is_video&&(null===(o=this.$refs.imageDisplay)||void 0===o||o.stop()),this.displayImage=!s.is_video,this.displayImage)?this.$refs.imageDisplay.start(s.url):null===(d=this.$refs.videoDisplay)||void 0===d||d.start(s.url);this.currentMedia=s}))},data(){return{displayImage:!0,currentMedia:null}},computed:{timeout(){return this.settingsStore.timeout}},watch:{"mediaStore.count"(e,t){}},methods:{nextMedia(){this.cycleManager.popIndex()},onMediaLoad(){this.timer=setTimeout((()=>this.nextMedia()),this.timeout)}}});var oe=i(9885);const se=(0,g.Z)(ie,[["render",u],["__scopeId","data-v-f011a9fa"]]),ne=se;$()(ie,"components",{QPage:oe.Z})}}]);
"use strict";(self["webpackChunkframeo_web"]=self["webpackChunkframeo_web"]||[]).push([[487],{7487:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Ye});var n=i(9835),o=i(6970);const r={id:"content-pane"},s={id:"media-box"},a={class:"media"},d={class:"media"},l={id:"info-box"},c={id:"uploader-box"},u={key:0,class:"gap"};function h(e,t,i,h,v,m){const p=(0,n.up)("user-actions"),g=(0,n.up)("image-display"),x=(0,n.up)("video-display"),k=(0,n.up)("date-block"),f=(0,n.up)("progress-block"),b=(0,n.up)("contributer-block"),w=(0,n.up)("description-block"),M=(0,n.up)("version-block"),y=(0,n.up)("q-page");return(0,n.wg)(),(0,n.j4)(y,{class:"flex flex-center"},{default:(0,n.w5)((()=>{var t,i,h,v,m;return[(0,n._)("div",r,[(0,n.Wm)(p,{onNext:e.onClickNext,onPrevious:e.onClickPrevious},null,8,["onNext","onPrevious"]),(0,n._)("div",s,[(0,n._)("div",a,[(0,n.Wm)(g,{class:(0,o.C_)({fade:!0,"fade-in":e.displayImage}),ref:"imageDisplay",onLoad:e.onMediaLoad,onError:e.onMediaError},null,8,["class","onLoad","onError"])]),(0,n._)("div",d,[(0,n.Wm)(x,{class:(0,o.C_)({fade:!0,"fade-in":!e.displayImage}),ref:"videoDisplay",onLoad:e.onMediaLoad,onError:e.onMediaError,onEnd:e.onMediaEnd},null,8,["class","onLoad","onError","onEnd"])])]),(0,n._)("div",l,[(0,n.Wm)(k,{id:"date",value:null===(t=e.currentMedia)||void 0===t?void 0:t.date},null,8,["value"]),(0,n.Wm)(f,{id:"progress",current:e.cycleManager.getIndex(),max:e.cycleManager.getMax()},null,8,["current","max"])]),(0,n._)("div",c,[(0,n.Wm)(b,{id:"contributer",name:null===(i=e.currentMedia)||void 0===i?void 0:i.contributer},null,8,["name"]),null!==(h=e.currentMedia)&&void 0!==h&&h.contributer&&null!==(v=e.currentMedia)&&void 0!==v&&v.description?((0,n.wg)(),(0,n.iD)("div",u)):(0,n.kq)("",!0),(0,n.Wm)(w,{id:"description",value:null===(m=e.currentMedia)||void 0===m?void 0:m.description},null,8,["value"])]),(0,n.Wm)(M,{id:"version",value:e.version},null,8,["value"])])]})),_:1})}const v={id:"container"},m=["src"];function p(e,t,i,r,s,a){return(0,n.wg)(),(0,n.iD)("div",v,[null!==e.currentSource?((0,n.wg)(),(0,n.iD)("div",{key:0,id:"backdrop",style:(0,o.j5)({backgroundImage:"url("+e.currentSource+")"})},null,4)):(0,n.kq)("",!0),null!==e.currentSource?((0,n.wg)(),(0,n.iD)("img",{key:1,id:"image-main",src:e.currentSource},null,8,m)):(0,n.kq)("",!0)])}const g=(0,n.aZ)({name:"ImageDisplay",emits:["load","error"],data(){return{currentSource:null,nextSource:""}},methods:{onImageLoad(){this.$emit("load"),this.currentSource=this.nextSource},stop(){this.currentSource=null},start(e){console.log(`Start load image ${e}`);const t=new Image;t.onload=this.onImageLoad,t.onerror=e=>{this.$emit("error",e)},t.src=this.nextSource=e}}});var x=i(1639);const k=(0,x.Z)(g,[["render",p],["__scopeId","data-v-5f32cb6a"]]),f=k;i(702);var b=i(1957);const w={id:"container"},M={id:"spinner"},y=["src"];function I(e,t,i,o,r,s){const a=(0,n.up)("q-spinner");return(0,n.wg)(),(0,n.iD)("div",w,[(0,n.wy)((0,n._)("div",M,[(0,n.Wm)(a,{color:"primary",size:"3em",thickness:10})],512),[[b.F8,e.loading]]),(0,n._)("video",{id:"video",ref:"video",muted:"",autoplay:"",onLoadeddata:t[0]||(t[0]=(...t)=>e.onVideoLoad&&e.onVideoLoad(...t)),onError:t[1]||(t[1]=(...t)=>e.onVideoError&&e.onVideoError(...t)),onEnded:t[2]||(t[2]=(...t)=>e.onVideoEnd&&e.onVideoEnd(...t))},[null!==e.source?((0,n.wg)(),(0,n.iD)("source",{key:0,src:e.source,type:"video/mp4"},null,8,y)):(0,n.kq)("",!0)],544)])}const _=(0,n.aZ)({name:"VideoDisplay",emits:["load","error","end"],data(){return{source:null,loading:!1}},computed:{video(){return this.$refs.video}},methods:{onVideoLoad(){this.$emit("load"),this.loading=!1,this.video.currentTime=0,this.video.play()},onVideoError(e){this.$emit("error",e)},onVideoEnd(){this.$emit("end")},stop(){this.video.pause()},start(e){console.log(`Start load video ${e}`),this.loading=!0,this.source=e,this.video.load()}}});var S=i(3940),D=i(9984),E=i.n(D);const C=(0,x.Z)(_,[["render",I],["__scopeId","data-v-651bc06f"]]),$=C;E()(_,"components",{QSpinner:S.Z});const Z=e=>((0,n.dD)("data-v-2969ba78"),e=e(),(0,n.Cn)(),e),N={id:"date"},L=Z((()=>(0,n._)("div",{id:"background"},null,-1))),V=Z((()=>(0,n._)("div",{id:"nailbar"},[(0,n._)("div",{class:"nail"}),(0,n._)("div",{class:"nail"})],-1))),O={id:"content"},W={class:"text"},A={class:"text"},B={class:"text"};function R(e,t,i,r,s,a){return(0,n.wg)(),(0,n.iD)("div",N,[L,V,(0,n._)("div",O,[(0,n._)("div",W,(0,o.zw)(e.dayName),1),(0,n._)("div",A,(0,o.zw)(e.day)+" "+(0,o.zw)(e.monthName)+" "+(0,o.zw)(e.year),1),(0,n._)("div",B,(0,o.zw)(e.hour)+":"+(0,o.zw)(e.minute),1)])])}i(6727);function z(e){return e<10?"0"+e:e}function q(e){return(null===e||void 0===e?void 0:e.charAt(0).toUpperCase())+(null===e||void 0===e?void 0:e.slice(1))}function P(e,t){if(void 0!==e){while(e.length>0&&t.includes(e.charAt(e.length-1)))e=e.slice(0,-1);return e}}const J="nl-NL",T=(0,n.aZ)({name:"DateBlock",props:{value:{type:String,default:null}},computed:{date(){return null===this.value?null:new Date(this.value.toString())},year(){var e;return null===(e=this.date)||void 0===e?void 0:e.getFullYear()},month(){var e;return z((null===(e=this.date)||void 0===e?void 0:e.getMonth())+1)},day(){var e;return null===(e=this.date)||void 0===e?void 0:e.getDate()},hour(){var e;return z(null===(e=this.date)||void 0===e?void 0:e.getHours())},minute(){var e;return z(null===(e=this.date)||void 0===e?void 0:e.getMinutes())},monthName(){var e;const t={month:"short"};return P(null===(e=this.date)||void 0===e?void 0:e.toLocaleDateString(J,t).toString(),".")},dayName(){var e;const t={weekday:"long"};return q(null===(e=this.date)||void 0===e?void 0:e.toLocaleDateString(J,t).toString())},text(){if(null===this.value)return null;const e={weekday:"long",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"},t=new Date(this.value.toString()),i=t.toLocaleDateString("nl-NL",e).toString();return i.charAt(0).toUpperCase()+i.slice(1)}}}),Q=(0,x.Z)(T,[["render",R],["__scopeId","data-v-2969ba78"]]),U=Q,j={id:"progress"};function F(e,t,i,r,s,a){return(0,n.wg)(),(0,n.iD)("div",j,(0,o.zw)(e.progress),1)}const H=(0,n.aZ)({name:"ProgressBlock",props:{current:{type:Number,default:0},max:{type:Number,default:0}},computed:{progress(){return`${this.current+1} / ${this.max}`}}}),Y=(0,x.Z)(H,[["render",F],["__scopeId","data-v-fdd0278c"]]),G=Y,K={id:"version"};function X(e,t,i,r,s,a){return(0,n.wg)(),(0,n.iD)("div",K,(0,o.zw)(e.value),1)}const ee=(0,n.aZ)({name:"VersionBlock",props:{value:{type:String,default:null}}}),te=(0,x.Z)(ee,[["render",X],["__scopeId","data-v-dc4d8a6e"]]),ie=te;function ne(e,t,i,r,s,a){const d=(0,n.up)("q-avatar"),l=(0,n.up)("q-chip");return null!=e.name&&""!==e.name?((0,n.wg)(),(0,n.j4)(l,{key:0,id:"contributer"},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{icon:"account_circle",color:"red","text-color":"white"}),(0,n.Uk)(" "+(0,o.zw)(e.name),1)])),_:1})):(0,n.kq)("",!0)}const oe=(0,n.aZ)({name:"ContributerBlock",props:{name:{type:String,default:null}}});var re=i(7328),se=i(1357);const ae=(0,x.Z)(oe,[["render",ne],["__scopeId","data-v-8ecabd3e"]]),de=ae;E()(oe,"components",{QChip:re.Z,QAvatar:se.Z});const le=e=>((0,n.dD)("data-v-17134b64"),e=e(),(0,n.Cn)(),e),ce={key:0,id:"description"},ue=le((()=>(0,n._)("div",{id:"background"},null,-1)));function he(e,t,i,r,s,a){return null!=e.value&&""!==e.value?((0,n.wg)(),(0,n.iD)("div",ce,[ue,(0,n.Uk)(" "+(0,o.zw)(e.value),1)])):(0,n.kq)("",!0)}const ve=(0,n.aZ)({name:"DescriptionBlock",props:{value:{type:String,default:null}}}),me=(0,x.Z)(ve,[["render",he],["__scopeId","data-v-17134b64"]]),pe=me,ge={id:"block"},xe={id:"swipebox"};function ke(e,t,i,o,r,s){const a=(0,n.up)("click-box"),d=(0,n.Q2)("touch-swipe");return(0,n.wg)(),(0,n.iD)("div",ge,[(0,n.Wm)(a,{class:"clickbox",id:"previous",onClick:e.onClickPrevious},null,8,["onClick"]),(0,n.Wm)(a,{class:"clickbox",id:"next",onClick:e.onClickNext},null,8,["onClick"]),(0,n.wy)((0,n._)("div",xe,null,512),[[d,e.handleSwipe,void 0,{mouse:!0,right:!0,left:!0}]])])}function fe(e,t,i,o,r,s){return(0,n.wg)(),(0,n.iD)("div",{id:"box",onClick:t[0]||(t[0]=(...t)=>e.onClick&&e.onClick(...t))})}const be=(0,n.aZ)({name:"ClickBox",emits:["click"],props:{timeout:{type:Number,default:250},max:{type:Number,default:3}},data(){return{clicks:0,timer:0}},methods:{onClick(){clearInterval(this.timer),this.clicks++,this.clicks>=this.max?this.fire():this.timer=setTimeout(this.fire,this.timeout)},fire(){const e=this.clicks;this.clicks=0,this.$emit("click",e)}}}),we=(0,x.Z)(be,[["render",fe],["__scopeId","data-v-05eebff3"]]),Me=we,ye=(0,n.aZ)({name:"UserActions",emits:["next","previous"],components:{ClickBox:Me},methods:{onClickPrevious(e){this.$emit("previous",e)},onClickNext(e){this.$emit("next",e)},handleSwipe(e){"left"!==e.direction?"right"!==e.direction||this.$emit("previous",1):this.$emit("next",1)}}});var Ie=i(4192);const _e=(0,x.Z)(ye,[["render",ke],["__scopeId","data-v-6201adc1"]]),Se=_e;E()(ye,"directives",{TouchSwipe:Ie.Z});var De=i(1644),Ee=i(7363);const Ce=JSON.parse('{"timeout":6000,"cutoffVideo":true}'),$e=(0,Ee.Q_)("SettingsStore",{state:()=>Ce,actions:{}});var Ze=i(932),Ne=i.n(Ze),Le=i(3511),Ve=i.n(Le),Oe=i(6031),We=i.n(Oe),Ae=(i(6822),new WeakMap);class Be{constructor(){Ne()(this,Ae,{writable:!0,value:void 0}),We()(this,Ae,new Map)}on(e,t){Ve()(this,Ae).has(e)?Ve()(this,Ae).get(e).push(t):Ve()(this,Ae).set(e,[t])}trigger(e,...t){for(const i of Ve()(this,Ae).get(e)||[])i(...t)}}var Re=new WeakMap,ze=new WeakMap;class qe extends Be{constructor(){super(),Ne()(this,Re,{writable:!0,value:void 0}),Ne()(this,ze,{writable:!0,value:void 0}),We()(this,Re,-1),We()(this,ze,0),this.peekIndex=this.peekIndex.bind(this),this.popIndex=this.popIndex.bind(this),this.getIndex=this.getIndex.bind(this),this.setIndex=this.setIndex.bind(this),this.getMax=this.getMax.bind(this),this.setMax=this.setMax.bind(this),this.removeIndex=this.removeIndex.bind(this),this.addOne=this.addOne.bind(this)}peekIndex(e=1){if("number"!==typeof e)throw new Error("Cannot read count as number");return 0===this.getMax()?-1:(this.getIndex()+e+this.getMax())%this.getMax()}popIndex(e=1){this.setIndex(this.peekIndex(e))}getIndex(){return Ve()(this,Re)}setIndex(e){if(e===Ve()(this,Re))return;const t=Ve()(this,Re);We()(this,Re,e),this.trigger("indexchanged",e,t)}getMax(){return Ve()(this,ze)}setMax(e){We()(this,ze,e)}removeIndex(e){Ve()(this,Re)>=e&&this.setIndex(Ve()(this,Re)-1)}addOne(){this.setMax(Ve()(this,ze)+1),1===this.getMax()&&this.setIndex(0)}}const Pe=JSON.parse('{"MAJOR":0,"MINOR":1,"RELEASE":11}');var Je=new WeakMap;class Te{get MAJOR(){return Ve()(this,Je).MAJOR}get MINOR(){return Ve()(this,Je).MINOR}get RELEASE(){return Ve()(this,Je).RELEASE}asString(){return`v${this.MAJOR}.${this.MINOR}.${this.RELEASE}`}constructor(){Ne()(this,Je,{writable:!0,value:void 0}),We()(this,Je,Pe),this.asString=this.asString.bind(this)}}const Qe=new Te,Ue=Qe,je=(0,n.aZ)({components:{ImageDisplay:f,VideoDisplay:$,DateBlock:U,VersionBlock:ie,ProgressBlock:G,UserActions:Se,ContributerBlock:de,DescriptionBlock:pe},name:"IndexPage",setup(){const e=(0,De.Z)(),t=new qe;return e.$onAction((({name:e,store:i,args:n,after:o,onError:r})=>{switch(e){case"addItem":o((e=>{!1!==e&&t.addOne()}));break;case"removeItem":{const e=n[0];o((i=>{!1!==i&&t.removeIndex(e)}));break}}})),{mediaStore:e,cycleManager:t,settingsStore:$e(),version:Ue.asString()}},created(){this.cycleManager.on("indexchanged",((e,t)=>{var i,n;if(console.debug(`Index changed from ${t} -> ${e}`),e<0)return;const o=this.mediaStore.mediaItems[e];if(void 0===o)return;const r=this.mediaStore.mediaItems[t],s=void 0===r||r.is_video!==o.is_video;var a;(s&&o.is_video&&(null===(i=this.$refs.videoDisplay)||void 0===i||i.stop()),s&&!o.is_video&&(null===(n=this.$refs.imageDisplay)||void 0===n||n.stop()),this.displayImage=!o.is_video,this.displayImage)?this.$refs.imageDisplay.start(o.url):null===(a=this.$refs.videoDisplay)||void 0===a||a.start(o.url);this.currentMedia=o}))},data(){return{displayImage:!0,currentMedia:null}},computed:{timeout(){return this.settingsStore["timeout"]},cutoffVideo(){return this.settingsStore["cutoffVideo"]}},watch:{"mediaStore.count"(e,t){}},methods:{nextMedia(e=1){this.cycleManager.popIndex(e)},onMediaLoad(){var e;(!0!==(null===(e=this.currentMedia)||void 0===e?void 0:e.is_video)||this.cutoffVideo)&&(clearTimeout(this.timer),this.timer=setTimeout((()=>this.nextMedia()),this.timeout))},onMediaEnd(){clearTimeout(this.timer),this.nextMedia()},onMediaError(e){var t;const i=this.currentMedia,n=i?i.is_video?"video":"image":"?",o=null!==(t=i.url)&&void 0!==t?t:"?",r=i?JSON.stringify(i):"{null}";console.error(`Could not load ${n} from source ${o}\n\n(${JSON.stringify(e)})\n\n${r}`),this.nextMedia()},onClickNext(e){switch(clearTimeout(this.timer),e){case 1:this.nextMedia(1);break;case 2:this.nextMedia(5);break;case 3:this.nextMedia(10);break;default:this.nextMedia(1)}},onClickPrevious(e){switch(clearTimeout(this.timer),e){case 1:this.nextMedia(-1);break;case 2:this.nextMedia(-5);break;case 3:this.nextMedia(-10);break;default:this.nextMedia(-1)}}}});var Fe=i(9885);const He=(0,x.Z)(je,[["render",h],["__scopeId","data-v-4ed0817f"]]),Ye=He;E()(je,"components",{QPage:Fe.Z})}}]);